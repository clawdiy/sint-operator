id: social-calendar
name: Social Media Calendar Pipeline
description: "Research trends → strategy → full content calendar with scheduled posts"
version: "2.0"

trigger:
  type: command
  pattern: "social.*calendar|content.*calendar|plan.*posts|schedule.*content"

inputs:
  - name: brand_profile
    type: reference
    description: "Brand profile for tone, audience, and platforms"
    default: active_brand
  - name: duration_weeks
    type: integer
    description: "Calendar duration in weeks"
    default: 4
  - name: platforms
    type: array
    description: "Target platforms"
    default: [instagram, tiktok, linkedin, twitter]
  - name: posts_per_week
    type: integer
    description: "Number of posts per platform per week"
    default: 5

steps:
  - id: research
    skill: trend-researcher
    modelTier: routine
    action: >
      Analyze current trends, hashtags, and viral content patterns
      for each target platform. Identify seasonal events, holidays,
      and industry moments within the calendar window.
    inputs:
      platforms: "${inputs.platforms}"
      brand_profile: "${inputs.brand_profile}"
      duration_weeks: "${inputs.duration_weeks}"
    output: trend_data

  - id: strategy
    skill: content-strategist
    modelTier: complex
    action: >
      Build a content strategy based on trends, brand goals, and
      audience insights. Define content pillars, posting cadence,
      optimal times, and content mix ratios per platform.
    inputs:
      trend_data: "$trend_data"
      brand_profile: "${inputs.brand_profile}"
      platforms: "${inputs.platforms}"
      posts_per_week: "${inputs.posts_per_week}"
    output: content_strategy

  - id: generate_calendar
    skill: calendar-generator
    modelTier: complex
    action: >
      Generate complete calendar with individual post entries.
      Each entry includes: date, time, platform, content type,
      caption/copy, hashtags, visual direction, and CTA.
    inputs:
      content_strategy: "$content_strategy"
      trend_data: "$trend_data"
      duration_weeks: "${inputs.duration_weeks}"
      brand_profile: "${inputs.brand_profile}"
    retry:
      max: 2
      backoff: exponential
    output: calendar

  - id: notify
    skill: notifier
    modelTier: routine
    action: >
      Send the completed calendar to the operator via preferred channel.
      Include summary stats and next-action recommendations.
    inputs:
      calendar: "$calendar"
      brand_profile: "${inputs.brand_profile}"
    output: notification_result

outputs:
  - format: calendar_json
    includes:
      - posts_by_date
      - platform_breakdown
      - hashtag_sets
      - visual_briefs
      - strategy_summary
